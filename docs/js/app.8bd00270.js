(function(e){function t(t){for(var n,i,o=t[0],c=t[1],l=t[2],h=0,u=[];h<o.length;h++)i=o[h],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&u.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(u.length)u.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,o=1;o<s.length;o++){var c=s[o];0!==a[c]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var n={},a={app:0},r=[];function i(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=n,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},1405:function(e,t,s){"use strict";s("92bd")},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("2b0e"),a=s("dc02"),r=s("43f9"),i=s.n(r),o=(s("d1e7"),s("43f4"),s("bb87"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("img",{attrs:{alt:"Vue logo",src:s("cf05")}}),n("MainView",{attrs:{msg:"Second Life Functions Web Interface"}})],1)}),c=[],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",[e._v(e._s(e.msg))]),s("md-field",{attrs:{id:"sl-host-field"}},[s("label",{attrs:{for:"sl-host"}},[e._v("SL Host")]),s("md-input",{attrs:{type:"text",name:"sl-host",id:"sl-host",autocomplete:"sl_host"},model:{value:e.sl_host,callback:function(t){e.sl_host=t},expression:"sl_host"}})],1),s("SpeechWidget",{attrs:{sl_host:e.sl_host}})],1)},d=[],h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("form",{staticClass:"md-layout",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.validateForm(t)}}},[s("md-card",{staticClass:"md-layout-item md-size-50 md-small-size-100"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Speech")])]),s("md-card-content",[s("div",{staticClass:"md-layout md-gutter"},[s("div",{staticClass:"md-layout-item md-small-size-100"},[s("md-field",{class:e.getValidationClass("speech_type")},[s("label",{attrs:{for:"speech-type"}},[e._v("Type")]),s("md-select",{attrs:{name:"speech-type",id:"speech-type","md-dense":"",disabled:e.sending},model:{value:e.form.speech_type,callback:function(t){e.$set(e.form,"speech_type",t)},expression:"form.speech_type"}},[s("md-option",{attrs:{value:"rlv_folders"}},[e._v("Query folders")]),s("md-option",{attrs:{value:"owner"}},[e._v("OwnerSay (self + @RLV)")]),s("md-option",{attrs:{value:"whisper"}},[e._v("Whisper (10 m)")]),s("md-option",{attrs:{value:"say"}},[e._v("Say (20 m)")]),s("md-option",{attrs:{value:"shout"}},[e._v("Shout (100 m)")])],1),s("span",{staticClass:"md-error"},[e._v("The type is required")])],1)],1),e.shouldShowChannel(e.form.speech_type)?s("div",{staticClass:"md-layout-item md-small-size-100"},[s("md-field",{class:e.getValidationClass("speech_channel")},[s("label",{attrs:{for:"speech-channel"}},[e._v("Channel")]),s("md-input",{attrs:{type:"number",id:"speech-channel",name:"speech-channel",disabled:e.sending},model:{value:e.form.speech_channel,callback:function(t){e.$set(e.form,"speech_channel",t)},expression:"form.speech_channel"}})],1)],1):e._e()]),e.shouldShowName(e.form.speech_type)?s("md-field",{class:e.getValidationClass("speech_name")},[s("label",{attrs:{for:"speech-name"}},[e._v("Name")]),s("md-input",{attrs:{type:"text",name:"speech-name",id:"speech-name",autocomplete:"speech_name",disabled:e.sending},model:{value:e.form.speech_name,callback:function(t){e.$set(e.form,"speech_name",t)},expression:"form.speech_name"}}),e.$v.form.speech_name.required?e._e():s("span",{staticClass:"md-error"},[e._v("Name is required")])],1):e._e(),e.shouldShowText(e.form.speech_type)?s("md-field",{class:e.getValidationClass("speech_text")},[s("label",{attrs:{for:"speech-text"}},[e._v("Text")]),s("md-textarea",{attrs:{name:"speech-text",id:"speech-text",autocomplete:"speech_text",disabled:e.sending},model:{value:e.form.speech_text,callback:function(t){e.$set(e.form,"speech_text",t)},expression:"form.speech_text"}}),e.$v.form.speech_text.required?e.$v.form.speech_text.maxLength?e._e():s("span",{staticClass:"md-error"},[e._v("Max 500 characters")]):s("span",{staticClass:"md-error"},[e._v("Text is required")])],1):e._e(),s("md-card",{staticClass:"md-layout-item"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Result")])]),s("md-card-content",[s("pre",{staticStyle:{width:"100%","text-align":"left"},style:{"background-color":e.lastResponse.succeeded?"":"red"},domProps:{textContent:e._s(e.responseJSON)}})])],1)],1),e.sending?s("md-progress-bar",{attrs:{"md-mode":"indeterminate"}}):e._e(),s("md-card-actions",[s("div",[s("md-switch",{staticClass:"md-primary",model:{value:e.showHistory,callback:function(t){e.showHistory=t},expression:"showHistory"}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Toggle history list")]),s("md-icon",{class:{"md-primary":e.showHistory}},[e._v("history")])],1)],1),s("md-button",{staticClass:"md-primary",attrs:{disabled:e.sending},on:{click:e.formSave}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Save")]),s("md-icon",[e._v("save")])],1),s("md-button",{staticClass:"md-primary",attrs:{disabled:e.sending},on:{click:e.formSend}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Execute")]),s("md-icon",[e._v("send")])],1)],1)],1),e.showHistory?s("md-card",{staticClass:"md-layout-item"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Speech history")])]),s("md-card-content",[s("md-field",{attrs:{"md-clearable":""}},[s("md-input",{attrs:{placeholder:"Search..."},on:{input:e.searchInHistory},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),s("md-chips",{attrs:{"md-placeholder":"Search tags..."},model:{value:e.searchTags,callback:function(t){e.searchTags=t},expression:"searchTags"}}),s("md-list",{staticClass:"history-list"},[s("draggable",e._b({on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}}},"draggable",e.dragOptions,!1),[s("transition-group",{attrs:{type:"transition",name:e.drag?null:"flip-list"}},e._l(e.filteredHistory,(function(t){return s("md-list-item",{key:t.id,staticClass:"history-list-item"},[s("div",{staticClass:"md-layout md-gutter"},[s("div",{staticClass:"md-layout-item md-size-5"},[s("md-speed-dial",{staticClass:"history-list-item-button",attrs:{"md-direction":"bottom"}},[s("md-speed-dial-target",{staticClass:"md-primary md-mini",on:{click:function(s){return e.historySend(t)}}},[s("md-icon",[e._v("send")])],1),s("md-speed-dial-content",[s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.historyEdit(t)}}},[s("md-icon",[e._v("edit")])],1),s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.historyDelete(t)}}},[s("md-icon",[e._v("delete")])],1)],1)],1)],1),s("div",{staticClass:"md-layout-item"},[s("md-table",[s("md-table-row",[s("md-table-cell",[s("span",{staticClass:"history-list-item-text",staticStyle:{"white-space":"pre"}},[e._v(e._s(t.text))])])],1),s("md-table-row",[s("md-table-cell",[s("md-chips",{attrs:{"md-check-duplicated":"","md-placeholder":"Add tag..."},model:{value:t.tags,callback:function(s){e.$set(t,"tags",s)},expression:"item.tags"}},["owner"!=t.type?s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("name:'"+e._s(t.name)+"'")]):e._e(),s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("type:'"+e._s(t.type)+"'")]),"owner"!=t.type?s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("channel:'"+e._s(t.channel)+"'")]):e._e()],1)],1)],1)],1)],1)])])})),1)],1)],1)],1)],1):e._e(),s("md-card",{staticClass:"md-layout-item"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Clothes")])]),s("md-card-content",[s("md-list",{staticClass:"clothes-list"},e._l(e.clothes,(function(t){return s("md-list-item",{key:t.name,staticClass:"clothes-list-item"},[s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.add_clothing(t)}}},[s("md-icon",[e._v("add")])],1),s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.remove_clothing(t)}}},[s("md-icon",[e._v("remove")])],1),s("div",{staticClass:"md-layout-item"},[e._v(e._s(t.name))])],1)})),1),s("md-field",[s("label",{attrs:{for:"clothes_template"}},[e._v("Template")]),s("md-textarea",{attrs:{name:"clothes_template"},model:{value:e.clothes_template,callback:function(t){e.clothes_template=t},expression:"clothes_template"}})],1),e._v(" Message "),s("pre",{staticStyle:{"text-align":"left"},domProps:{textContent:e._s(e.clothes_message)}}),s("md-button",{staticClass:"md-icon-button",on:{click:function(t){return e.dumpClothes()}}},[s("md-icon",[e._v("edit")])],1),s("md-button",{staticClass:"md-icon-button",on:{click:function(t){return e.updateClothes()}}},[s("md-icon",[e._v("refresh")])],1)],1)],1),e.lastSpeech?s("md-snackbar",{attrs:{"md-active":e.formSend},on:{"update:mdActive":function(t){e.formSend=t},"update:md-active":function(t){e.formSend=t}}},[e._v('The command "Speech" has issued '+e._s(e.lastSpeech.type)+' with the text "'+e._s(e.lastSpeech.text)+'" on channel '+e._s(e.lastSpeech.channel))]):e._e()],1)])},u=[],p=(s("456d"),s("53ca")),m=(s("ac4d"),s("8a81"),s("5df3"),s("10ad"),s("3b2b"),s("55dd"),s("a481"),s("386d"),s("20d6"),s("28a5"),s("ffc1"),s("ac6a"),s("7514"),s("7f7f"),s("6762"),s("2fdb"),s("262e")),f=(s("99de"),s("7e84"),s("9072")),g=s("1dce"),v=s("b76a"),y=s.n(v),_=s("b5ae");function x(e,t){x=function(e,t){return new r(e,void 0,t)};var s=Object(f["a"])(RegExp),n=RegExp.prototype,a=new WeakMap;function r(e,t,n){var r=s.call(this,e,t);return a.set(r,n||a.get(e)),r}function i(e,t){var s=a.get(t);return Object.keys(s).reduce((function(t,n){return t[n]=e[s[n]],t}),Object.create(null))}return Object(m["a"])(r,s),r.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=i(t,this)),t},r.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var s=a.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+s[t]})))}if("function"===typeof t){var r=this;return n[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==Object(p["a"])(e[e.length-1])&&e.push(i(e,r)),t.apply(this,e)}))}return n[Symbol.replace].call(this,e,t)},x.apply(this,arguments)}var b={name:"SpeechWidget",mixins:[g["validationMixin"]],components:{draggable:y.a},props:{sl_host:{required:!1}},data:function(){return{nameRegex:x(/name:'((?:(?!')[\s\S])+)'/i,{name:1}),typeRegex:x(/type:'((?:(?!')[\s\S])+)'/i,{type:1}),channelRegex:x(/channel:'((?:(?!')[\s\S])+)'/i,{channel:1}),tagsRegex:x(/tag:'((?:(?!')[\s\S])+)'/gi,{tag:1}),form:{speech_type:"SAY",speech_channel:0,speech_name:null,speech_text:null},showHistory:!0,search:null,searchTags:[],clothes_template:"Clothes:\n\t<item>",clothes:[],haveLoaded:!1,history_count:0,history:[],drag:!1,sending:!1,lastSpeech:null,lastResponse:{succeeded:!0,response:void 0}}},validations:{form:{speech_channel:{required:_["required"]},speech_name:{required:_["required"]},speech_text:{required:_["required"],maxLength:Object(_["maxLength"])(500)}}},methods:{shouldShowName:function(e){return!["owner","rlv_folders"].includes(e)},shouldShowChannel:function(e){return!["owner","rlv_folders"].includes(e)},shouldShowText:function(e){return![].includes(e)},formToItem:function(){var e=this.form.speech_name,t=this.form.speech_type,s=this.form.speech_text,n=this.form.speech_channel;if(!s&&this.shouldShowText(t))throw"No text!";if(!e&&this.shouldShowName(t))throw"No name!";var a={name:e,type:t,text:s,channel:n,id:++this.history_count,tags:[]};return"owner"==t?(delete a.name,delete a.channel):"rlv_folders"==t&&(delete a.name,delete a.channel,a.type="RLV_QUERY",a.text="@getinv:".concat(a.text,"=456446"),a.channel=456446),a},formSave:function(){var e=this.formToItem(),t=(e.name||"").toUpperCase(),s=e.type.toUpperCase(),n=(e.text||"").toUpperCase(),a=e.channel;return this.history.find((function(e){return(e.name||"").toUpperCase()==t&&e.type.toUpperCase()==s&&(e.text||"").toUpperCase()==n&&e.channel==a}))||this.history.push(e),e},sendSpeech:function(e){var t=this;t.lastResponse={succeeded:!0,response:void 0},t.sending=!0;var s={cmd:"msg",type:e.type,text:e.text,name:e.name,channel:e.channel};Object.entries(s).filter((function(e){return void 0==e[1]})).forEach((function(e){return delete s[e[0]]})),"RLV_QUERY"==e.type&&(s.cmd="RLV_QUERY",delete s.type);var n=t.sl_host;return"/"!=n.split("").pop()&&(n+="/"),this.$jsonp(n,s).then((function(e){return e.success?t.lastResponse={succeeded:!0,response:e.data}:t.lastResponse={succeeded:!1,response:e.data},t.lastResponse}),(function(){t.lastResponse={succeeded:!1,response:"Network / url"}})).finally((function(){t.sending=!1}))},historySend:function(e){this.sendSpeech(e)},historyEdit:function(e){this.form.speech_name=e.name,this.form.speech_type=e.type,this.form.speech_text=e.text,this.form.speech_channel=e.channel},historyDelete:function(e){var t=this.history.findIndex((function(t){return t==e}));-1!=t&&this.history.splice(t,1)},searchInHistory:function(){var e=this,t=this.search||"",s=this.nameRegex.exec(t);if(s){var n=this.searchTags.findIndex((function(t){return null!=e.nameRegex.exec(t)})),a="name:'".concat(s.groups["name"],"'");-1!=n?this.searchTags.splice(n,1,a):this.searchTags.push(a)}t=t.replace(this.nameRegex,"");var r=this.typeRegex.exec(t);if(r){var i=this.searchTags.findIndex((function(t){return null!=e.typeRegex.exec(t)})),o="type:'".concat(r.groups["type"],"'");-1!=i?this.searchTags.splice(i,1,o):this.searchTags.push(o)}t=t.replace(this.typeRegex,"");var c,l=this.channelRegex.exec(t);if(l){var d=this.searchTags.findIndex((function(t){return null!=e.channelRegex.exec(t)})),h="channel:'".concat(l.groups["channel"],"'");-1!=d?this.searchTags.splice(d,1,h):this.searchTags.push(h)}t=t.replace(this.channelRegex,"");while(null!=(c=this.tagsRegex.exec(t))){var u=c.groups["tag"];this.searchTags.find(u)||this.searchTags.push(u)}t=t.replace(this.tagsRegex,""),t=t.trim(),this.search=t},getValidationClass:function(e){var t=this.$v.form[e];if(t)return{"md-invalid":t.$invalid&&t.$dirty}},clearForm:function(){this.$v.$reset(),this.form.speech_type="SAY",this.form.speech_channel=0,this.form.speech_name=null,this.form.speech_text=null},formSend:function(){this.sending=!0;var e=this.formSave();this.sendSpeech(e)},validateForm:function(e){var t=e.explicitOriginalTarget,s=!1;while(t&&!(s="BUTTON"==t.tagName&&"submit"==t.type))t=t.parentElement;if(!s)return!1;this.$v.$touch(),this.$v.$invalid||this.formSend()},updateClothes:function(){var e=this;this.sendSpeech({type:"RLV_QUERY",text:"@getinv:.wardrobe/Clothes=456445",channel:456445}).then((function(t){t.succeeded&&(e.clothes=t.response.response.split(",").filter((function(e){return e})).sort().map((function(e){return{name:e}})).sort())}))},dumpClothes:function(){this.shouldShowText(this.form.speech_type)||(this.form.speech_type="SAY"),this.form.speech_text=this.clothes_message},remove_clothing:function(e){this.sendSpeech({type:"owner",text:"@detachall:.wardrobe/Clothes/".concat(e.name,"=force")})},add_clothing:function(e){this.sendSpeech({type:"owner",text:"@attachall:.wardrobe/Clothes/".concat(e.name,"=force")})}},computed:{clothes_message:function(){var e=this;return this.clothes_template.split("\n").map((function(t){return-1!=t.indexOf("<item>")?e.clothes.map((function(e){return t.replace("<item>",e.name)})).join("\n"):t})).join("\n")},responseJSON:function(){return JSON.stringify(this.lastResponse.response,void 0,2)},filteredHistory:function(){var e=this,t=this.searchTags;t=t.map((function(e){return e.trim().toUpperCase()}));var s=this.searchTags.map((function(t){return e.nameRegex.exec(t)})).filter((function(e){return null!=e})).pop(),n=s&&s.groups["name"],a=this.searchTags.map((function(t){return e.typeRegex.exec(t)})).filter((function(e){return null!=e})).pop(),r=a&&a.groups["type"],i=this.searchTags.map((function(t){return e.channelRegex.exec(t)})).filter((function(e){return null!=e})).pop(),o=i&&i.groups["channel"],c=this.history;if(n&&(c=c.filter((function(e){return e.name.toUpperCase()==n.toUpperCase()})),t=t.filter((function(t){return null==e.nameRegex.exec(t)}))),r&&(c=c.filter((function(e){return e.type.toUpperCase()==r.toUpperCase()})),t=t.filter((function(t){return null==e.typeRegex.exec(t)}))),o&&(c=c.filter((function(e){return e.channel==o})),t=t.filter((function(t){return null==e.channelRegex.exec(t)}))),t.length>0&&(c=c.filter((function(e){return t.every((function(t){return e.tags.find((function(e){return e.toUpperCase()==t}))}))}))),this.search){var l=this.search.trim();l&&(c=c.filter((function(e){return e.text.toUpperCase().includes(l.toUpperCase())})))}return c},dragOptions:function(){return{animation:200,group:"history",disabled:!1,ghostClass:"ghost"}}},mounted:function(){var e=localStorage.getItem("speech-history");e&&(e=JSON.parse(e),this.history=e.history||[],this.history_count=e.history_count||0),this.haveLoaded=!0},watch:{history:{handler:function(){this.haveLoaded&&localStorage.setItem("speech-history",JSON.stringify({history:this.history||[],history_count:this.history_count||0}))},deep:!0}}},S=b,C=(s("fe9f"),s("2877")),w=Object(C["a"])(S,h,u,!1,null,"e8687b26",null),R=w.exports,O={name:"HelloWorld",components:{SpeechWidget:R},props:{msg:String},watch:{sl_host:function(e){var t=this.getOptionsFromHash();t.sl_host!=e&&(t.url=e,location.hash=encodeURIComponent(JSON.stringify(t)))}},methods:{getOptionsFromHash:function(){var e=location.hash.substring(1);return e?JSON.parse(decodeURIComponent(location.hash.substring(1))):{}},loadOptionsFromHash:function(){try{var e=this.getOptionsFromHash();e.url&&(this.sl_host=e.url)}catch(t){console.warn(t)}}},mounted:function(){var e=this;e.loadOptionsFromHash(),window.addEventListener("hashchange",(function(){e.loadOptionsFromHash()}),!1)},data:function(){return{sl_host:""}}},T=O,k=(s("1405"),Object(C["a"])(T,l,d,!1,null,"2eb3a3d2",null)),$=k.exports,j={name:"app",components:{MainView:$}},U=j,H=(s("034f"),Object(C["a"])(U,o,c,!1,null,null,null)),N=H.exports;n["default"].use(a["a"]),n["default"].use(i.a),n["default"].config.productionTip=!1,new n["default"]({render:function(e){return e(N)}}).$mount("#app")},"85ec":function(e,t,s){},"92bd":function(e,t,s){},"9fe0":function(e,t,s){},cf05:function(e,t,s){e.exports=s.p+"img/logo.82b9c7a5.png"},fe9f:function(e,t,s){"use strict";s("9fe0")}});
//# sourceMappingURL=app.8bd00270.js.map