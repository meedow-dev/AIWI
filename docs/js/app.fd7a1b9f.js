(function(e){function t(t){for(var n,i,c=t[0],o=t[1],l=t[2],p=0,h=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&h.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,c=1;c<s.length;c++){var o=s[c];0!==a[o]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=s[0]))}return e}var n={},a={app:0},r=[];function i(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=n,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=o;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},1922:function(e,t,s){},5481:function(e,t,s){"use strict";s("1922")},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var n=s("2b0e"),a=s("43f9"),r=s.n(a),i=(s("d1e7"),s("43f4"),s("bb87"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("img",{attrs:{alt:"Vue logo",src:s("cf05")}}),n("MainView",{attrs:{msg:"Second Life Functions Web Interface"}})],1)}),c=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",[e._v(e._s(e.msg))]),s("md-field",{attrs:{id:"sl-host-field"}},[s("label",{attrs:{for:"sl-host"}},[e._v("SL Host")]),s("md-input",{attrs:{type:"text",name:"sl-host",id:"sl-host",autocomplete:"sl_host"},model:{value:e.sl_host,callback:function(t){e.sl_host=t},expression:"sl_host"}})],1),s("SpeechWidget",{attrs:{sl_host:e.sl_host}})],1)},l=[],d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._v(" Host: "+e._s(e.sl_host)+" "),s("form",{staticClass:"md-layout",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.validateForm(t)}}},[s("md-card",{staticClass:"md-layout-item md-size-50 md-small-size-100"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Speech")])]),s("md-card-content",[s("div",{staticClass:"md-layout md-gutter"},[s("div",{staticClass:"md-layout-item md-small-size-100"},[s("md-field",{class:e.getValidationClass("speech_type")},[s("label",{attrs:{for:"speech-type"}},[e._v("Type")]),s("md-select",{attrs:{name:"speech-type",id:"speech-type","md-dense":"",disabled:e.sending},model:{value:e.form.speech_type,callback:function(t){e.$set(e.form,"speech_type",t)},expression:"form.speech_type"}},[s("md-option",{attrs:{value:"owner"}},[e._v("OwnerSay (self + @RLV)")]),s("md-option",{attrs:{value:"whisper"}},[e._v("Whisper (10 m)")]),s("md-option",{attrs:{value:"say"}},[e._v("Say (20 m)")]),s("md-option",{attrs:{value:"shout"}},[e._v("Shout (100 m)")])],1),s("span",{staticClass:"md-error"},[e._v("The type is required")])],1)],1),"owner"!=e.form.speech_type?s("div",{staticClass:"md-layout-item md-small-size-100"},[s("md-field",{class:e.getValidationClass("speech_channel")},[s("label",{attrs:{for:"speech-channel"}},[e._v("Channel")]),s("md-input",{attrs:{type:"number",id:"speech-channel",name:"speech-channel",disabled:e.sending},model:{value:e.form.speech_channel,callback:function(t){e.$set(e.form,"speech_channel",t)},expression:"form.speech_channel"}})],1)],1):e._e()]),"owner"!=e.form.speech_type?s("md-field",{class:e.getValidationClass("speech_name")},[s("label",{attrs:{for:"speech-name"}},[e._v("Name")]),s("md-input",{attrs:{type:"text",name:"speech-name",id:"speech-name",autocomplete:"speech_name",disabled:e.sending},model:{value:e.form.speech_name,callback:function(t){e.$set(e.form,"speech_name",t)},expression:"form.speech_name"}}),e.$v.form.speech_name.required?e._e():s("span",{staticClass:"md-error"},[e._v("Name is required")])],1):e._e(),s("md-field",{class:e.getValidationClass("speech_text")},[s("label",{attrs:{for:"speech-text"}},[e._v("Text")]),s("md-textarea",{attrs:{name:"speech-text",id:"speech-text",autocomplete:"speech_text",disabled:e.sending},model:{value:e.form.speech_text,callback:function(t){e.$set(e.form,"speech_text",t)},expression:"form.speech_text"}}),e.$v.form.speech_text.required?e.$v.form.speech_text.maxLength?e._e():s("span",{staticClass:"md-error"},[e._v("Max 500 characters")]):s("span",{staticClass:"md-error"},[e._v("Text is required")])],1),s("md-card",{staticClass:"md-layout-item"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Result")])]),s("md-card-content",[s("iframe",{staticStyle:{width:"100%"},style:{"background-color":e.lastResponse.succeeded?"":"red"},attrs:{src:e.resultFrameSrc}})])],1)],1),e.sending?s("md-progress-bar",{attrs:{"md-mode":"indeterminate"}}):e._e(),s("md-card-actions",[s("div",[s("md-switch",{staticClass:"md-primary",model:{value:e.showHistory,callback:function(t){e.showHistory=t},expression:"showHistory"}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Toggle history list")]),s("md-icon",{class:{"md-primary":e.showHistory}},[e._v("history")])],1)],1),s("md-button",{staticClass:"md-primary",attrs:{disabled:e.sending},on:{click:e.formSave}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Save")]),s("md-icon",[e._v("save")])],1),s("md-button",{staticClass:"md-primary",attrs:{type:"submit",disabled:e.sending}},[s("md-tooltip",{attrs:{"md-direction":"top"}},[e._v("Execute")]),s("md-icon",[e._v("send")])],1)],1)],1),e.showHistory?s("md-card",{staticClass:"md-layout-item"},[s("md-card-header",[s("div",{staticClass:"md-title"},[e._v("Speech history")])]),s("md-card-content",[s("md-field",{attrs:{"md-clearable":""}},[s("md-input",{attrs:{placeholder:"Search..."},on:{input:e.searchInHistory},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),s("md-chips",{attrs:{"md-placeholder":"Search tags..."},model:{value:e.searchTags,callback:function(t){e.searchTags=t},expression:"searchTags"}}),s("md-list",{staticClass:"history-list"},[s("draggable",e._b({on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}}},"draggable",e.dragOptions,!1),[s("transition-group",{attrs:{type:"transition",name:e.drag?null:"flip-list"}},e._l(e.filteredHistory,(function(t){return s("md-list-item",{key:t.id,staticClass:"history-list-item"},[s("div",{staticClass:"md-layout md-gutter"},[s("div",{staticClass:"md-layout-item md-size-5"},[s("md-speed-dial",{staticClass:"history-list-item-button",attrs:{"md-direction":"bottom"}},[s("md-speed-dial-target",{staticClass:"md-primary md-mini",on:{click:function(s){return e.historySend(t)}}},[s("md-icon",[e._v("send")])],1),s("md-speed-dial-content",[s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.historyEdit(t)}}},[s("md-icon",[e._v("edit")])],1),s("md-button",{staticClass:"md-icon-button",on:{click:function(s){return e.historyDelete(t)}}},[s("md-icon",[e._v("delete")])],1)],1)],1)],1),s("div",{staticClass:"md-layout-item"},[s("md-table",[s("md-table-row",[s("md-table-cell",[s("span",{staticClass:"history-list-item-text",staticStyle:{"white-space":"pre"}},[e._v(e._s(t.text))])])],1),s("md-table-row",[s("md-table-cell",[s("md-chips",{attrs:{"md-check-duplicated":"","md-placeholder":"Add tag..."},model:{value:t.tags,callback:function(s){e.$set(t,"tags",s)},expression:"item.tags"}},["owner"!=t.type?s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("name:'"+e._s(t.name)+"'")]):e._e(),s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("type:'"+e._s(t.type)+"'")]),"owner"!=t.type?s("md-chip",{staticClass:"md-primary",staticStyle:{"margin-right":"4px"}},[e._v("channel:'"+e._s(t.channel)+"'")]):e._e()],1)],1)],1)],1)],1)])])})),1)],1)],1)],1)],1):e._e(),e.lastSpeech?s("md-snackbar",{attrs:{"md-active":e.formSend},on:{"update:mdActive":function(t){e.formSend=t},"update:md-active":function(t){e.formSend=t}}},[e._v('The command "Speech" has issued '+e._s(e.lastSpeech.type)+' with the text "'+e._s(e.lastSpeech.text)+'" on channel '+e._s(e.lastSpeech.channel))]):e._e()],1)])},p=[],h=(s("456d"),s("53ca")),u=(s("ac4d"),s("8a81"),s("ac6a"),s("5df3"),s("10ad"),s("3b2b"),s("6762"),s("2fdb"),s("a481"),s("386d"),s("20d6"),s("96cf"),s("1da1")),m=(s("7f7f"),s("7514"),s("262e")),f=(s("99de"),s("7e84"),s("9072")),g=s("1dce"),y=s("b76a"),v=s.n(y),_=s("b5ae");function x(e,t){x=function(e,t){return new r(e,void 0,t)};var s=Object(f["a"])(RegExp),n=RegExp.prototype,a=new WeakMap;function r(e,t,n){var r=s.call(this,e,t);return a.set(r,n||a.get(e)),r}function i(e,t){var s=a.get(t);return Object.keys(s).reduce((function(t,n){return t[n]=e[s[n]],t}),Object.create(null))}return Object(m["a"])(r,s),r.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=i(t,this)),t},r.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var s=a.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+s[t]})))}if("function"===typeof t){var r=this;return n[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==Object(h["a"])(e[e.length-1])&&e.push(i(e,r)),t.apply(this,e)}))}return n[Symbol.replace].call(this,e,t)},x.apply(this,arguments)}var b={name:"SpeechWidget",mixins:[g["validationMixin"]],components:{draggable:v.a},props:{sl_host:{required:!1}},data:function(){return{nameRegex:x(/name:'((?:(?!')[\s\S])+)'/i,{name:1}),typeRegex:x(/type:'((?:(?!')[\s\S])+)'/i,{type:1}),channelRegex:x(/channel:'((?:(?!')[\s\S])+)'/i,{channel:1}),tagsRegex:x(/tag:'((?:(?!')[\s\S])+)'/gi,{tag:1}),form:{speech_type:"SAY",speech_channel:0,speech_name:null,speech_text:null},showHistory:!0,search:null,searchTags:[],haveLoaded:!1,history_count:0,history:[],drag:!1,sending:!1,lastSpeech:null,lastResponse:{succeeded:!0,response:""}}},validations:{form:{speech_type:{required:_["required"]},speech_channel:{required:_["required"]},speech_name:{required:_["required"]},speech_text:{required:_["required"],maxLength:Object(_["maxLength"])(500)}}},methods:{formSave:function(){var e=this.form.speech_name,t=this.form.speech_type,s=this.form.speech_text,n=this.form.speech_channel;if(!t||!s)return null;if("owner"!=t&&!e)return null;var a={name:e,type:t,text:s,channel:n,id:++this.history_count,tags:[]};return"owner"==t&&(a.name=e="",a.channel=n=0),e=e.toUpperCase(),t=t.toUpperCase(),s=s.toUpperCase(),this.history.find((function(a){return a.name.toUpperCase()==e&&a.type.toUpperCase()==t&&a.text.toUpperCase()==s&&a.channel==n}))||this.history.push(a),a},sendSpeech:function(e){var t=this;t.lastResponse={succeeded:!0,response:""},t.sending=!0;var s={cmd:"msg",type:e.type,text:e.text,name:e.name,chan:e.channel};fetch(t.sl_host,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",body:JSON.stringify(s)}).then(function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(s){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.text();case 2:n=e.sent,s.ok?t.lastResponse={succeeded:!0,response:n}:t.lastResponse={succeeded:!1,response:n};case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.lastResponse={succeeded:!1,response:e.message}})).finally((function(){t.sending=!1}))},historySend:function(e){this.sendSpeech(e)},historyEdit:function(e){this.form.speech_name=e.name,this.form.speech_type=e.type,this.form.speech_text=e.text,this.form.speech_channel=e.channel},historyDelete:function(e){var t=this.history.findIndex((function(t){return t==e}));-1!=t&&this.history.splice(t,1)},searchInHistory:function(){var e=this,t=this.search||"",s=this.nameRegex.exec(t);if(s){var n=this.searchTags.findIndex((function(t){return null!=e.nameRegex.exec(t)})),a="name:'".concat(s.groups["name"],"'");-1!=n?this.searchTags.splice(n,1,a):this.searchTags.push(a)}t=t.replace(this.nameRegex,"");var r=this.typeRegex.exec(t);if(r){var i=this.searchTags.findIndex((function(t){return null!=e.typeRegex.exec(t)})),c="type:'".concat(r.groups["type"],"'");-1!=i?this.searchTags.splice(i,1,c):this.searchTags.push(c)}t=t.replace(this.typeRegex,"");var o,l=this.channelRegex.exec(t);if(l){var d=this.searchTags.findIndex((function(t){return null!=e.channelRegex.exec(t)})),p="channel:'".concat(l.groups["channel"],"'");-1!=d?this.searchTags.splice(d,1,p):this.searchTags.push(p)}t=t.replace(this.channelRegex,"");while(null!=(o=this.tagsRegex.exec(t))){var h=o.groups["tag"];this.searchTags.find(h)||this.searchTags.push(h)}t=t.replace(this.tagsRegex,""),t=t.trim(),this.search=t},getValidationClass:function(e){var t=this.$v.form[e];if(t)return{"md-invalid":t.$invalid&&t.$dirty}},clearForm:function(){this.$v.$reset(),this.form.speech_type="SAY",this.form.speech_channel=0,this.form.speech_name=null,this.form.speech_text=null},formSend:function(){this.sending=!0;var e=this.formSave();this.sendSpeech(e)},validateForm:function(e){var t=e.explicitOriginalTarget,s=!1;while(t&&!(s="BUTTON"==t.tagName&&"submit"==t.type))t=t.parentElement;if(!s)return!1;this.$v.$touch(),this.$v.$invalid||this.formSend()}},computed:{resultFrameSrc:function(){return"data:text/html;charset=utf-8,"+escape(this.lastResponse.response)},filteredHistory:function(){var e=this,t=this.searchTags;t=t.map((function(e){return e.trim().toUpperCase()}));var s=this.searchTags.map((function(t){return e.nameRegex.exec(t)})).filter((function(e){return null!=e})).pop(),n=s&&s.groups["name"],a=this.searchTags.map((function(t){return e.typeRegex.exec(t)})).filter((function(e){return null!=e})).pop(),r=a&&a.groups["type"],i=this.searchTags.map((function(t){return e.channelRegex.exec(t)})).filter((function(e){return null!=e})).pop(),c=i&&i.groups["channel"],o=this.history;if(n&&(o=o.filter((function(e){return e.name.toUpperCase()==n.toUpperCase()})),t=t.filter((function(t){return null==e.nameRegex.exec(t)}))),r&&(o=o.filter((function(e){return e.type.toUpperCase()==r.toUpperCase()})),t=t.filter((function(t){return null==e.typeRegex.exec(t)}))),c&&(o=o.filter((function(e){return e.channel==c})),t=t.filter((function(t){return null==e.channelRegex.exec(t)}))),t.length>0&&(o=o.filter((function(e){return t.every((function(t){return e.tags.find((function(e){return e.toUpperCase()==t}))}))}))),this.search){var l=this.search.trim();l&&(o=o.filter((function(e){return e.text.toUpperCase().includes(l.toUpperCase())})))}return o},dragOptions:function(){return{animation:200,group:"history",disabled:!1,ghostClass:"ghost"}}},mounted:function(){var e=localStorage.getItem("speech-history");e&&(e=JSON.parse(e),this.history=e.history||[],this.history_count=e.history_count||0);try{var t=JSON.parse(decodeURIComponent(location.hash.substring(1)));t.url&&(this.sl_host=t.url)}catch(s){console.warn(s)}this.haveLoaded=!0},watch:{history:{handler:function(){this.haveLoaded&&localStorage.setItem("speech-history",JSON.stringify({history:this.history||[],history_count:this.history_count||0}))},deep:!0}}},S=b,C=(s("dfb3"),s("2877")),w=Object(C["a"])(S,d,p,!1,null,"5434558d",null),R=w.exports,T={name:"HelloWorld",components:{SpeechWidget:R},props:{msg:String},data:function(){return{sl_host:""}}},O=T,k=(s("5481"),Object(C["a"])(O,o,l,!1,null,"7a668652",null)),$=k.exports,j={name:"app",components:{MainView:$}},U=j,q=(s("034f"),Object(C["a"])(U,i,c,!1,null,null,null)),H=q.exports;n["default"].use(r.a),n["default"].config.productionTip=!1,new n["default"]({render:function(e){return e(H)}}).$mount("#app")},"85ec":function(e,t,s){},cf05:function(e,t,s){e.exports=s.p+"img/logo.82b9c7a5.png"},dfb3:function(e,t,s){"use strict";s("e272")},e272:function(e,t,s){}});
//# sourceMappingURL=app.fd7a1b9f.js.map